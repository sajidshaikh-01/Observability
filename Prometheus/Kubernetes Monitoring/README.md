# Kubernetes Monitoring – How It Works in Production 

* What monitoring means in Kubernetes
* What components are monitored
* How metrics flow
* Which tools are used in real production
* How incidents are detected

This is written for **DevOps / SRE interviews and real-world usage**.

---

## What is Kubernetes Monitoring?

Kubernetes monitoring is the process of **collecting, storing, visualizing, and alerting on metrics** from:

* Kubernetes cluster
* Nodes
* Pods & containers
* Applications

In simple words:

> **Kubernetes monitoring tells us whether the cluster and workloads are healthy or not.**

---

## Why Monitoring is Critical in Kubernetes

Kubernetes is:

* Dynamic
* Distributed
* Self-healing

Problems:

* Pods restart automatically
* Nodes can disappear
* Scaling happens frequently

Without monitoring:

* You don’t know *why* something broke
* You only know *after users complain*

---

## What Do We Monitor in Kubernetes?

### 1️⃣ Cluster Level

* API server availability
* Scheduler health
* Controller manager health

---

### 2️⃣ Node Level

* CPU usage
* Memory usage
* Disk usage
* Network usage

---

### 3️⃣ Pod & Container Level

* CPU & memory per pod
* Pod restarts
* OOMKilled containers
* Pod status (Running, Pending, CrashLoopBackOff)

---

### 4️⃣ Application Level

* Request rate
* Error rate
* Latency
* Custom business metrics

---

## Core Monitoring Components in Kubernetes

### 1️⃣ Metrics Source

Metrics are generated by:

* Applications (custom metrics)
* Nodes (OS metrics)
* Kubernetes components

---

### 2️⃣ Exporters (VERY IMPORTANT)

Exporters expose metrics in Prometheus format.

Common exporters:

* Node Exporter → node metrics
* kube-state-metrics → Kubernetes object state
* cAdvisor → container metrics

---

### 3️⃣ Metrics Collection System

Prometheus is the most common tool.

Responsibilities:

* Discover targets dynamically
* Scrape `/metrics`
* Store metrics as time-series
* Evaluate alert rules

---

### 4️⃣ Visualization

Grafana is used to:

* Build dashboards
* Visualize cluster health
* Track trends

---

### 5️⃣ Alerting

Alertmanager is used to:

* Group alerts
* Deduplicate alerts
* Route alerts to Slack / Email / PagerDuty

---

## Kubernetes Monitoring Architecture (Logical Flow)

```text
Kubernetes Components
   ↓
Exporters (/metrics)
   ↓
Prometheus (scrape & store)
   ↓
Alertmanager (notifications)
   ↓
Grafana (dashboards)
```

---

## How Monitoring Works (Step-by-Step)

### Step 1️⃣ Metrics Exposure

* Nodes, pods, and apps expose metrics via exporters
* Metrics are available at `/metrics`

---

### Step 2️⃣ Service Discovery

* Prometheus uses Kubernetes API
* Dynamically finds nodes, pods, services

---

### Step 3️⃣ Scraping Metrics

* Prometheus pulls metrics at a fixed interval
* Stores metrics in TSDB

---

### Step 4️⃣ Visualization

* Grafana queries Prometheus using PromQL
* Dashboards show real-time & historical data

---

### Step 5️⃣ Alerting

* Prometheus evaluates alert rules
* Alerts sent to Alertmanager
* Notifications sent to engineers

---

## Common Kubernetes Monitoring Tools (Production)

| Purpose          | Tool               |
| ---------------- | ------------------ |
| Metrics          | Prometheus         |
| Dashboards       | Grafana            |
| Alerts           | Alertmanager       |
| Kubernetes state | kube-state-metrics |
| Node metrics     | Node Exporter      |
| Logs (optional)  | Loki / EFK         |

---

## kube-state-metrics (Important Concept)

kube-state-metrics provides:

* Pod status
* Deployment replicas
* Node conditions

Example:

* Desired replicas vs available replicas

It **does NOT provide CPU/memory**.

---

## Metrics Server vs Prometheus (Common Confusion)

| Metrics Server  | Prometheus          |
| --------------- | ------------------- |
| Used for HPA    | Used for monitoring |
| Short-term data | Long-term storage   |
| Limited metrics | Rich metrics        |

---

## Monitoring Use Cases in Production

* Detect pod crashes
* Detect node pressure
* Trigger autoscaling
* Capacity planning
* SLI / SLO tracking

---

## Common Interview Traps

❌ "Kubernetes monitors itself" → Wrong
❌ "Metrics Server replaces Prometheus" → Wrong
❌ "Logs are metrics" → Wrong

---

## Interview One-Liner

> Kubernetes monitoring involves collecting metrics from cluster components, nodes, pods, and applications using exporters and Prometheus, visualizing them in Grafana, and alerting via Alertmanager.

---

